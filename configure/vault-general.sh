#!/usr/bin/env bash
set -x
###----------------------------------------------------------------------------
### VARIABLES
###----------------------------------------------------------------------------

POLICY=

###----------------------------------------------------------------------------
### FUNCTIONS
###----------------------------------------------------------------------------
policy() {    
    FILE_PATH=$(dirname "$0")/../policies/${POLICY}
    FILE=${FILE_PATH##*/}
    NAME=${FILE%.*}

    vault policy write ${NAME} ${FILE_PATH}
}

###----------------------------------------------------------------------------
### MAIN PROGRAM
###----------------------------------------------------------------------------

while true; do
  case "$1" in

    -p | --policy )
        POLICY=$2; 
        policy; 
        shift;;


    -- ) shift; break ;;
    * ) break ;;
  esac
done