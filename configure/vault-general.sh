#!/usr/bin/env bash
###----------------------------------------------------------------------------
### VARIABLES
###----------------------------------------------------------------------------

policy=

###----------------------------------------------------------------------------
### FUNCTIONS
###----------------------------------------------------------------------------
policy() {    
    file_path=$(dirname "$0")/../policies/${policy}
    file=${file_path##*/}
    name=${file%.*}

    vault policy write ${name} ${file_path}
}

###----------------------------------------------------------------------------
### MAIN PROGRAM
###----------------------------------------------------------------------------

while true; do
  case "$1" in

    -p | --policy )
        policy=$2; 
        policy; 
        shift;;


    -- ) shift; break ;;
    * ) break ;;
  esac
done